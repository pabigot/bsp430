<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BSP430: include/bsp430/periph/ucs.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSP430
   &#160;<span id="projectnumber">20130327</span>
   </div>
   <div id="projectbrief">Board Support Package for MSP430 microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b88edee3dd3c84f98132ff53401cb3f9.html">bsp430</a></li><li class="navelem"><a class="el" href="dir_9cb70b0f81efa0454c88900ecd971aae.html">periph</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ucs.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Hardware presentation/abstraction for Unified Clock System (UCS).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="clock_8h_source.html">bsp430/clock.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="periph_8h_source.html">bsp430/periph.h</a>&gt;</code><br/>
</div>
<p><a href="ucs_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a999080243c756fa394083717b7908e1d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a999080243c756fa394083717b7908e1d">BSP430_MODULE_UCS</a></td></tr>
<tr class="separator:a999080243c756fa394083717b7908e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487d75be1b22fcbfb6c371b9fd34f58b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a487d75be1b22fcbfb6c371b9fd34f58b">configBSP430_UCS_TRIM_DCOCLKDIV</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a487d75be1b22fcbfb6c371b9fd34f58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b278cfc9dc95e656ea096c5263ed59e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a3b278cfc9dc95e656ea096c5263ed59e">BSP430_UCS_TRIM_DCOCLKDIV</a>&#160;&#160;&#160;include &lt;bsp430/platform.h&gt;</td></tr>
<tr class="separator:a3b278cfc9dc95e656ea096c5263ed59e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abad2320aeb13b65c846841d957f9dd39"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#abad2320aeb13b65c846841d957f9dd39">BSP430_UCS_FLL_SELREF</a>&#160;&#160;&#160;<a class="el" href="msp430_8h.html#a23efe8df30c23012fc0693861f5945e5">SELREF__XT1CLK</a></td></tr>
<tr class="separator:abad2320aeb13b65c846841d957f9dd39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a7fc35f409c746874cdfe5c6504121"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#aa6a7fc35f409c746874cdfe5c6504121">BSP430_UCS_DCO_IS_FAULTED_NI</a>()&#160;&#160;&#160;(UCSCTL7 &amp; DCOFFG)</td></tr>
<tr class="separator:aa6a7fc35f409c746874cdfe5c6504121"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a481dc0e205f4f3d1266c046c0048dcb2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a481dc0e205f4f3d1266c046c0048dcb2">BSP430_UCS_LFXT1_IS_FAULTED_NI</a>()&#160;&#160;&#160;(UCSCTL7 &amp; XT1LFOFFG)</td></tr>
<tr class="separator:a481dc0e205f4f3d1266c046c0048dcb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac414873a9494ebb25a4c76fc943680b7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#ac414873a9494ebb25a4c76fc943680b7">BSP430_UCS_XT2_IS_FAULTED_NI</a>()&#160;&#160;&#160;(UCSCTL7 &amp; BSP430_UCS_XT2OFFG_)</td></tr>
<tr class="separator:ac414873a9494ebb25a4c76fc943680b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a0cdc169aac90a5c877b3ca09a4608d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a7a0cdc169aac90a5c877b3ca09a4608d">BSP430_CLOCK_LFXT1_IS_FAULTED_NI</a>()&#160;&#160;&#160;((UCSCTL6 &amp; XT1OFF) || <a class="el" href="ucs_8h.html#a481dc0e205f4f3d1266c046c0048dcb2">BSP430_UCS_LFXT1_IS_FAULTED_NI</a>())</td></tr>
<tr class="separator:a7a0cdc169aac90a5c877b3ca09a4608d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad464616a6b90463f1eae80399c34905"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#aad464616a6b90463f1eae80399c34905">BSP430_CLOCK_XT2_IS_FAULTED_NI</a>()&#160;&#160;&#160;((UCSCTL6 &amp; BSP430_UCS_XT2OFF_) || <a class="el" href="ucs_8h.html#ac414873a9494ebb25a4c76fc943680b7">BSP430_UCS_XT2_IS_FAULTED_NI</a>())</td></tr>
<tr class="separator:aad464616a6b90463f1eae80399c34905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1438a6247f046287fbcbd6d4aecca486"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a1438a6247f046287fbcbd6d4aecca486">BSP430_UCS_CLEAR_FAULTS_NI</a>()</td></tr>
<tr class="separator:a1438a6247f046287fbcbd6d4aecca486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193ffc3b8d68bc1ec72dbeb887061af2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a193ffc3b8d68bc1ec72dbeb887061af2">BSP430_CLOCK_CLEAR_FAULTS_NI</a>()</td></tr>
<tr class="separator:a193ffc3b8d68bc1ec72dbeb887061af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4253e74bf9b15ba67fac82790ec629f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#ab4253e74bf9b15ba67fac82790ec629f">BSP430_CLOCK_LFXT1_XCAP</a>&#160;&#160;&#160;<a class="el" href="msp430_8h.html#af0c275c45d19c84f5edf7d7148935d95">XCAP_1</a></td></tr>
<tr class="separator:ab4253e74bf9b15ba67fac82790ec629f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad464616a6b90463f1eae80399c34905"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#aad464616a6b90463f1eae80399c34905">BSP430_CLOCK_XT2_IS_FAULTED_NI</a>()&#160;&#160;&#160;(UCSCTL7 &amp; XT2OFFG)</td></tr>
<tr class="separator:aad464616a6b90463f1eae80399c34905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2ace757e68c3bc4206f0ff4a3a39d13"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#ae2ace757e68c3bc4206f0ff4a3a39d13">BSP430_CLOCK_NOMINAL_VLOCLK_HZ</a>&#160;&#160;&#160;10000U</td></tr>
<tr class="separator:ae2ace757e68c3bc4206f0ff4a3a39d13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c49529cfa0ba1ada6819dfe6c5d68e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a24c49529cfa0ba1ada6819dfe6c5d68e">BSP430_CLOCK_PUC_MCLK_HZ</a>&#160;&#160;&#160;1048576UL</td></tr>
<tr class="separator:a24c49529cfa0ba1ada6819dfe6c5d68e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0679992097fef5a5a89161e99a47227d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a0679992097fef5a5a89161e99a47227d">BSP430_UCS_NOMINAL_REFOCLK_HZ</a>&#160;&#160;&#160;32768U</td></tr>
<tr class="separator:a0679992097fef5a5a89161e99a47227d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a12d4e6a1d8f43f1ee6af044d952d8441"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ucs_8h.html#a12d4e6a1d8f43f1ee6af044d952d8441">iBSP430ucsTrimDCOCLKDIV_ni</a> ()</td></tr>
<tr class="separator:a12d4e6a1d8f43f1ee6af044d952d8441"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Hardware presentation/abstraction for Unified Clock System (UCS). </p>
<p>The Unified Clock System (UCS) is present in 5xx/6xx-family devices. A variant UCS_RF differs from UCS by adding support for XT2. This difference is currently ignored.</p>
<h1><a class="anchor" id="h_periph_ucs_opt"></a>
Module Configuration Options</h1>
<ul>
<li><a class="el" href="ucs_8h.html#a487d75be1b22fcbfb6c371b9fd34f58b">configBSP430_UCS_TRIM_DCOCLKDIV</a> enables specific MCLK frequencies to be configured</li>
</ul>
<h1><a class="anchor" id="h_periph_ucs_hpl"></a>
Hardware Presentation Layer</h1>
<p>As there can be only one instance of UCS on any MCU, there is no structure supporting a UCS <a class="el" href="layer.html#HPL">HPL</a>. Manipulate the peripheral through its registers directly.</p>
<h1><a class="anchor" id="h_periph_ucs_hal"></a>
Hardware Adaptation Layer</h1>
<p>As there can be only one instance of UCS on any MCU, there is no structure supporting a UCS <a class="el" href="layer.html#HAL">HAL</a>.</p>
<p>The standard set of capabilities in the bsp430/clocks.h header are supported, with the following details:</p>
<ul>
<li>Comparison of SMCLK against a clock of known frequency is required to set MCLK frequencies as there are no DCO calibration constants for this peripheral. <a class="el" href="bsp430__config_8h.html" title="BSP430 application and platform configuration directives.">bsp430/platform/bsp430_config.h</a> will automatically request the required <a class="el" href="group__grp__timer__ccaclk.html#ga21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> in support of this unless <a class="el" href="ucs_8h.html#a487d75be1b22fcbfb6c371b9fd34f58b">configBSP430_UCS_TRIM_DCOCLKDIV</a> is explicitly disabled.</li>
</ul>
<ul>
<li>FLLREFDIV is /1.</li>
</ul>
<ul>
<li>MCLK and SMCLK are sourced from DCOCLKDIV</li>
</ul>
<ul>
<li>DCOCLKDIV is DCOCLK/2 (the power-up value)</li>
</ul>
<ul>
<li>FLL trimming will leave the FLL disabled if it was disabled on entry; see <a class="el" href="core_8h.html#a6c655623731b60f2257aedfb35e3cfa1">configBSP430_CORE_DISABLE_FLL</a>.</li>
</ul>
<ul>
<li>Executing an FLL trim (either directly or due to having invoked <a class="el" href="clock_8h.html#a538f01f39cf54267229fe04877d3185e">ulBSP430clockConfigureMCLK_ni()</a>) will record in private state the measured clock frequency.</li>
</ul>
<ul>
<li><a class="el" href="clock_8h.html#a5d5257ff00b9fafcd86e4f5eaa73ee79">ulBSP430clockMCLK_Hz_ni()</a> and <a class="el" href="clock_8h.html#a0642c6f082ed8feafd057ff8132b75da">ulBSP430clockSMCLK_Hz_ni()</a> return values are calculated by applying the relevant clock dividers as read from the UCS registers to the recorded measured clock frequency.</li>
</ul>
<dl class="section user"><dt>Homepage</dt><dd><a href="http://github.com/pabigot/bsp430">http://github.com/pabigot/bsp430</a> </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2012-2013, Peter A. Bigot. Licensed under <a href="http://www.opensource.org/licenses/BSD-3-Clause">BSD-3-Clause</a> </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a193ffc3b8d68bc1ec72dbeb887061af2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_CLEAR_FAULTS_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                             \</div>
<div class="line">    BSP430_UCS_CLEAR_FAULTS_NI();                                       \</div>
<div class="line">    BSP430_CLOCK_OSC_CLEAR_FAULT_NI();                                  \</div>
<div class="line">  } <span class="keywordflow">while</span> (0)</div>
</div><!-- fragment --><p>Clear all clock faults.</p>
<p>This definition overrides the generic definition to clear the crystal-specific flags as well as the system flag.</p>
<dl class="section user"><dt>Defaulted:</dt><dd>The value here is superseded by previously encountered definitions. </dd></dl>

</div>
</div>
<a class="anchor" id="a7a0cdc169aac90a5c877b3ca09a4608d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_LFXT1_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;((UCSCTL6 &amp; XT1OFF) || <a class="el" href="ucs_8h.html#a481dc0e205f4f3d1266c046c0048dcb2">BSP430_UCS_LFXT1_IS_FAULTED_NI</a>())</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the UCS-controlled LFXT1 crystal has a fault condition.</p>
<dl class="section note"><dt>Note</dt><dd>Oscillator fault flags are not set unless a fault has been detected. If the crystal has never been enabled, no fault will have been detected. On power-up, the XIN function is not enabled and UCSCTL6.XT1OFF is set, and BSP430 treats UCSCTL6.XT1OFF as an indication that the pins are not configured for crystal use, either because LFXT1 has not been configured or has been configured and found to be faulted. Although it is perfectly acceptable to have UCSCTL6.XT1OFF set and the crystal working fine, the complexity of detecting that case is not supported by this implementation.</dd></dl>
<dl class="section user"><dt>Defaulted:</dt><dd>The value here is superseded by previously encountered definitions.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="ucs_8h.html#a481dc0e205f4f3d1266c046c0048dcb2">BSP430_UCS_LFXT1_IS_FAULTED_NI()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ab4253e74bf9b15ba67fac82790ec629f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_LFXT1_XCAP&#160;&#160;&#160;<a class="el" href="msp430_8h.html#af0c275c45d19c84f5edf7d7148935d95">XCAP_1</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Peripheral default setting for platform-specific constant </p>

</div>
</div>
<a class="anchor" id="ae2ace757e68c3bc4206f0ff4a3a39d13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_NOMINAL_VLOCLK_HZ&#160;&#160;&#160;10000U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unconditional define for peripheral-specific constant </p>

</div>
</div>
<a class="anchor" id="a24c49529cfa0ba1ada6819dfe6c5d68e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_PUC_MCLK_HZ&#160;&#160;&#160;1048576UL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unconditional define for peripheral-specific constant </p>

</div>
</div>
<a class="anchor" id="aad464616a6b90463f1eae80399c34905"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_XT2_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;((UCSCTL6 &amp; BSP430_UCS_XT2OFF_) || <a class="el" href="ucs_8h.html#ac414873a9494ebb25a4c76fc943680b7">BSP430_UCS_XT2_IS_FAULTED_NI</a>())</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the UCS-controlled XT2 crystal has a fault condition.</p>
<dl class="section note"><dt>Note</dt><dd>Oscillator fault flags are not set unless a fault has been detected. If the crystal has never been enabled, no fault will have been detected. On power-up, the XT2IN function is not enabled and UCSCTL6.XT2OFF is set, and BSP430 treats UCSCTL6.XT2OFF as an indication that the pins are not configured for crystal use, either because XT2 has not been configured or has been configured and found to be faulted. Although it is perfectly acceptable to have UCSCTL6.XT2OFF set and the crystal working fine, the complexity of detecting that case is not supported by this implementation.</dd></dl>
<dl class="section user"><dt>Defaulted:</dt><dd>The value here is superseded by previously encountered definitions.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="ucs_8h.html#ac414873a9494ebb25a4c76fc943680b7">BSP430_UCS_XT2_IS_FAULTED_NI()</a></dd></dl>
<p>Check whether the XT2 crystal has a fault condition.</p>
<p>This definition overrides the generic definition to test the crystal-specific flags. It applies only when the MCU supports XT2 as determined by an available platform definition for <a class="el" href="periph_8h.html#af75a5f76a171a5dba8c94a6d06371026">BSP430_PERIPH_XT2</a>.</p>
<dl class="section user"><dt>Dependency:</dt><dd><a class="el" href="periph_8h.html#af75a5f76a171a5dba8c94a6d06371026">BSP430_PERIPH_XT2</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aad464616a6b90463f1eae80399c34905"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_CLOCK_XT2_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(UCSCTL7 &amp; XT2OFFG)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check whether the UCS-controlled XT2 crystal has a fault condition.</p>
<dl class="section note"><dt>Note</dt><dd>Oscillator fault flags are not set unless a fault has been detected. If the crystal has never been enabled, no fault will have been detected. On power-up, the XT2IN function is not enabled and UCSCTL6.XT2OFF is set, and BSP430 treats UCSCTL6.XT2OFF as an indication that the pins are not configured for crystal use, either because XT2 has not been configured or has been configured and found to be faulted. Although it is perfectly acceptable to have UCSCTL6.XT2OFF set and the crystal working fine, the complexity of detecting that case is not supported by this implementation.</dd></dl>
<dl class="section user"><dt>Defaulted:</dt><dd>The value here is superseded by previously encountered definitions.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="ucs_8h.html#ac414873a9494ebb25a4c76fc943680b7">BSP430_UCS_XT2_IS_FAULTED_NI()</a></dd></dl>
<p>Check whether the XT2 crystal has a fault condition.</p>
<p>This definition overrides the generic definition to test the crystal-specific flags. It applies only when the MCU supports XT2 as determined by an available platform definition for <a class="el" href="periph_8h.html#af75a5f76a171a5dba8c94a6d06371026">BSP430_PERIPH_XT2</a>.</p>
<dl class="section user"><dt>Dependency:</dt><dd><a class="el" href="periph_8h.html#af75a5f76a171a5dba8c94a6d06371026">BSP430_PERIPH_XT2</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a999080243c756fa394083717b7908e1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_MODULE_UCS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(defined(__MSP430_HAS_UCS__)          \</div>
<div class="line">                           || defined(__MSP430_HAS_UCS_RF__))</div>
</div><!-- fragment --><p>Defined on inclusion of &lt;<a class="el" href="ucs_8h.html" title="Hardware presentation/abstraction for Unified Clock System (UCS).">bsp430/periph/ucs.h</a>&gt;. The value evaluates to true if the target MCU supports the Unified Clock System, and false if it does not.</p>
<dl class="section user"><dt>C Preprocessor Only:</dt><dd>This macro may have a value that permits its use only within C preprocessor conditional directives. </dd></dl>

</div>
</div>
<a class="anchor" id="a1438a6247f046287fbcbd6d4aecca486"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_CLEAR_FAULTS_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                               \</div>
<div class="line">    UCSCTL7 &amp;= ~(BSP430_UCS_XT2OFFG_ | BSP430_UCS_XT1HFOFFG_ | XT1LFOFFG | DCOFFG); \</div>
<div class="line">  } <span class="keywordflow">while</span> (0)                                                           \</div>
</div><!-- fragment --><p>Clear all UCS-specific faults. </p>

</div>
</div>
<a class="anchor" id="aa6a7fc35f409c746874cdfe5c6504121"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_DCO_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(UCSCTL7 &amp; DCOFFG)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>UCS-specific check for DCO fault condition </p>

</div>
</div>
<a class="anchor" id="abad2320aeb13b65c846841d957f9dd39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_FLL_SELREF&#160;&#160;&#160;<a class="el" href="msp430_8h.html#a23efe8df30c23012fc0693861f5945e5">SELREF__XT1CLK</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Preferred source for FLL clock</p>
<p>This should be a constant denoting the bits to be set in the UCS control register for SELREF selecting the FLL reference clock. The default value selects XT1CLK, which will internally fall back to REFOCLK if XT1CLK is faulted.</p>
<dl class="section user"><dt>C Preprocessor Only:</dt><dd>This macro may have a value that permits its use only within C preprocessor conditional directives. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="bootstrap_2clocks_2main_8c-example.html#a36">bootstrap/clocks/main.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a481dc0e205f4f3d1266c046c0048dcb2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_LFXT1_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(UCSCTL7 &amp; XT1LFOFFG)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>UCS-specific check for LFXT1 crystal fault condition.</p>
<p>This checks exactly for the fault condition.</p>
<dl class="section note"><dt>Note</dt><dd>A crystal that has never been enabled will not register as faulted. </dd></dl>

</div>
</div>
<a class="anchor" id="a0679992097fef5a5a89161e99a47227d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_NOMINAL_REFOCLK_HZ&#160;&#160;&#160;32768U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The UCS module supports an internally trimmed reference oscillator running at a nominal 32 KiHz rate, for use where XT1 is not populated. </p>

</div>
</div>
<a class="anchor" id="a3b278cfc9dc95e656ea096c5263ed59e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_TRIM_DCOCLKDIV&#160;&#160;&#160;include &lt;bsp430/platform.h&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Defined to a true value if <a class="el" href="ucs_8h.html#a487d75be1b22fcbfb6c371b9fd34f58b">configBSP430_UCS_TRIM_DCOCLKDIV</a> was requested and <a class="el" href="group__grp__timer__ccaclk.html#gafaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a> is available on the platform.</p>
<p>In the absence of this flag, <a class="el" href="ucs_8h.html#a12d4e6a1d8f43f1ee6af044d952d8441">iBSP430ucsTrimDCOCLKDIV_ni()</a> will not be available and must not be referenced.</p>
<dl class="section user"><dt>Dependency:</dt><dd><a class="el" href="ucs_8h.html#a487d75be1b22fcbfb6c371b9fd34f58b">configBSP430_UCS_TRIM_DCOCLKDIV</a>, <a class="el" href="group__grp__timer__ccaclk.html#gafaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a> </dd></dl>
<dl class="section user"><dt>Platform-Dependent Default:</dt><dd>Undefined here; include &lt;<a class="el" href="platform_8h.html" title="Entrypoint for platform-specific capabilities.">bsp430/platform.h</a>&gt; to obtain the correct value of this macro. </dd></dl>

</div>
</div>
<a class="anchor" id="ac414873a9494ebb25a4c76fc943680b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_UCS_XT2_IS_FAULTED_NI</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(UCSCTL7 &amp; BSP430_UCS_XT2OFFG_)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>UCS-specific check for XT2 crystal fault condition.</p>
<p>If the platform does not support an XT2 crystal no fault is diagnosed.</p>
<dl class="section note"><dt>Note</dt><dd>A crystal that has never been enabled will not register as faulted. </dd></dl>

</div>
</div>
<a class="anchor" id="a487d75be1b22fcbfb6c371b9fd34f58b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define configBSP430_UCS_TRIM_DCOCLKDIV&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define to a true value to request that ulBSP430ucsTrimDCOCLKDIV_ni() be made available.</p>
<p>Because implementation of this function depends on <a class="el" href="group__grp__timer__ccaclk.html#gafaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a>, setting this option causes &lt;<a class="el" href="bsp430__config_8h.html" title="BSP430 application and platform configuration directives.">bsp430/platform/bsp430_config.h</a>&gt; to default <a class="el" href="group__grp__timer__ccaclk.html#ga21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> to true.</p>
<p>This value represents an application or system request for the feature; availability of the feature must be tested using <a class="el" href="ucs_8h.html#a3b278cfc9dc95e656ea096c5263ed59e">BSP430_UCS_TRIM_DCOCLKDIV</a> before attempting to invoke the function.</p>
<dl class="section note"><dt>Note</dt><dd>This function is the only mechanism by which the UCS DCO can be configured by BSP430.</dd></dl>
<dl class="section user"><dt>C Preprocessor Only:</dt><dd>This macro may have a value that permits its use only within C preprocessor conditional directives.</dd></dl>
<dl class="section user"><dt>Affects:</dt><dd><a class="el" href="ucs_8h.html#a3b278cfc9dc95e656ea096c5263ed59e">BSP430_UCS_TRIM_DCOCLKDIV</a> </dd></dl>
<dl class="section user"><dt>Dependency:</dt><dd><a class="el" href="group__grp__timer__ccaclk.html#gafaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a> </dd></dl>
<dl class="section user"><dt>Defaulted:</dt><dd>The value here is superseded by previously encountered definitions. </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a12d4e6a1d8f43f1ee6af044d952d8441"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430ucsTrimDCOCLKDIV_ni </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adjust the FLL as necessary to maintain the last configured DCOCLKDIV speed</p>
<p>This function is most likely to be used if <a class="el" href="core_8h.html#a6c655623731b60f2257aedfb35e3cfa1">configBSP430_CORE_DISABLE_FLL</a> is set, but is also a required subroutine of the UCS implementation of <a class="el" href="clock_8h.html#a538f01f39cf54267229fe04877d3185e">ulBSP430clockConfigureMCLK_ni()</a>.</p>
<p>The function is expected to be used periodically to maintain an already configured clock in the face of varying voltage, temperature, and other factors such as chip errata that introduce clock drift. The implementation is not entitled to reconfigure to a different DCO range selection, should that be supported by the clock. Consequently, oscillator faults may result if the system drifts so far that the target frequency cannot be represented within the current range. In such a situation, <a class="el" href="clock_8h.html#a538f01f39cf54267229fe04877d3185e">ulBSP430clockConfigureMCLK_ni()</a> should be re-invoked to configure the clock.</p>
<p>Trimming is done relative to XT1CLK (if available) or REFOCLK (otherwise).</p>
<dl class="section warning"><dt>Warning</dt><dd>This function will temporarily reconfigure MCLK, SMCLK, and ACLK. Any peripherals that depend on those clocks should be disabled while the function is executing.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the trimming was completed successfully, -1 if an error occurred. Potential errors are inability to access <a class="el" href="group__grp__timer__ccaclk.html#gaaf21a38de49b7d31cba4066c0ce80720">BSP430_TIMER_CCACLK_PERIPH_HANDLE</a>, and use of XT2CLK for FLLREFCLK.</dd></dl>
<dl class="section user"><dt>Dependency:</dt><dd><a class="el" href="ucs_8h.html#a3b278cfc9dc95e656ea096c5263ed59e">BSP430_UCS_TRIM_DCOCLKDIV</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 27 2013 12:01:53 for BSP430 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
