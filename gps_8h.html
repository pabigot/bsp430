<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BSP430: include/bsp430/utility/gps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSP430
   &#160;<span id="projectnumber">20130427</span>
   </div>
   <div id="projectbrief">Board Support Package for MSP430 microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b88edee3dd3c84f98132ff53401cb3f9.html">bsp430</a></li><li class="navelem"><a class="el" href="dir_3a342b515484da5d2be804b4d00fb40f.html">utility</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gps.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Standardized interface for GPS sensors.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="core_8h_source.html">bsp430/core.h</a>&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
</div>
<p><a href="gps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a680ff27c476697f91fcee7a5bddb5243"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a680ff27c476697f91fcee7a5bddb5243">BSP430_GPS_EPOCH_POSIX</a>&#160;&#160;&#160;315964800UL</td></tr>
<tr class="separator:a680ff27c476697f91fcee7a5bddb5243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4dbc266ca6eeac56eee2aa5946411fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#ab4dbc266ca6eeac56eee2aa5946411fb">BSP430_GPS_GPS_UTC_OFFSET_S</a>&#160;&#160;&#160;-16</td></tr>
<tr class="separator:ab4dbc266ca6eeac56eee2aa5946411fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7482fba2c644ff9d5acd1945f397aefb"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a7482fba2c644ff9d5acd1945f397aefb">iBSP430gpsSerialCallback_ni</a> )(const uint8_t *msg, size_t len, unsigned long rx_utt)</td></tr>
<tr class="separator:a7482fba2c644ff9d5acd1945f397aefb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa482fb931136beea5423b9369617da85"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#aa482fb931136beea5423b9369617da85">iBSP430gpsPPSCallback_ni</a> )(unsigned long pps_tck)</td></tr>
<tr class="separator:aa482fb931136beea5423b9369617da85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae4e88ea10b61ab79a0d718a2db0dd91"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#aae4e88ea10b61ab79a0d718a2db0dd91">iBSP430gpsTransmitComplete_ni</a> )(const uint8_t *msg, int rc)</td></tr>
<tr class="separator:aae4e88ea10b61ab79a0d718a2db0dd91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40c1d7be45e0e2200baf289eb8b65bf9"><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a40c1d7be45e0e2200baf289eb8b65bf9">sBSP430gpsConfiguration</a></td></tr>
<tr class="separator:a40c1d7be45e0e2200baf289eb8b65bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2fbd65b94db95384ae39b310173a106a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a2fbd65b94db95384ae39b310173a106a">vBSP430gpsReleaseMessage_ni</a> (const uint8_t *msg)</td></tr>
<tr class="separator:a2fbd65b94db95384ae39b310173a106a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34edaac99e0aa4ef7e4ecb906a5a17f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a34edaac99e0aa4ef7e4ecb906a5a17f5">iBSP430gpsInitialize_ni</a> (const <a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a> *configp, void *devconfigp)</td></tr>
<tr class="separator:a34edaac99e0aa4ef7e4ecb906a5a17f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad964af943254cd00bd92afa9b5cc6421"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#ad964af943254cd00bd92afa9b5cc6421">iBSP430gpsShutdown_ni</a> ()</td></tr>
<tr class="separator:ad964af943254cd00bd92afa9b5cc6421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28de69936bd921716528678a7718f2bc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a28de69936bd921716528678a7718f2bc">iBSP430gpsGPStoUTCOffset_s_ni</a> (void)</td></tr>
<tr class="separator:a28de69936bd921716528678a7718f2bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adafbf0ed765345d6a46e470f0000edbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#adafbf0ed765345d6a46e470f0000edbc">vBSP430gpsGPStoUTCOffset_s_ni</a> (int gps_to_utc_offset_s)</td></tr>
<tr class="separator:adafbf0ed765345d6a46e470f0000edbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c372f07bd98a2de291929c21a749caa"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a3c372f07bd98a2de291929c21a749caa">xBSP430gpsConvertGPStoUTC_ni</a> (unsigned int weekno, unsigned long sow)</td></tr>
<tr class="separator:a3c372f07bd98a2de291929c21a749caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58f896ebe61b9270135bd9b92358a483"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gps_8h.html#a58f896ebe61b9270135bd9b92358a483">iBSP430gpsTransmit_ni</a> (const uint8_t *msg, size_t len, <a class="el" href="gps_8h.html#aae4e88ea10b61ab79a0d718a2db0dd91">iBSP430gpsTransmitComplete_ni</a> complete_cb)</td></tr>
<tr class="separator:a58f896ebe61b9270135bd9b92358a483"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Standardized interface for GPS sensors. </p>
<p>This header declares functions that should be implemented for specific GPS sensors, such as the <a class="el" href="skytraq_8h.html">SkyTraq Venus 638FLPx</a>, to provide access to NMEA messages and a one-pulse-per-second (1PPS) capability. See <a class="el" href="ex_sensors_venus6pps.html">Sensors: SkyTraq Venus 638FLPx as Time Source</a> for an example application.</p>
<p>The API also includes some functions implemented in a generic module to assist with decoding NMEA sentences and converting between GPS and UTC time bases. BSP430 re-uses the time representation of POSIX <code>time_t</code> and <code>struct tm</code>, and may assume availability of functions in the POSIX <code>&lt;time.h&gt;</code> header.</p>
<p>The intent is that generic GPS capability is implemented in accordance with this header, but specific devices may provide enhanced capabilities in device-specific headers.</p>
<dl class="section note"><dt>Note</dt><dd>Much of this module was created to leverage the 1PPS and time-keeping capabilities of the GPS system to provide clock data for a wireless sensor network. There are references to leap seconds, POSIX time encodings, UTC and GPS time systems, and POSIX and GPS epochs. The documentation assumes the reader is familiar with these concepts. If you are not, see <a href="http://www.usno.navy.mil/USNO/time/gps">http://www.usno.navy.mil/USNO/time/gps</a> and <a href="http://www.madore.org/~david/computers/unix-leap-seconds.html">http://www.madore.org/~david/computers/unix-leap-seconds.html</a> among <a href="http://lmgtfy.com/?q=gps+time">other references</a>.</dd></dl>
<dl class="section user"><dt>Homepage</dt><dd><a href="http://github.com/pabigot/bsp430">http://github.com/pabigot/bsp430</a> </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2013, Peter A. Bigot. Licensed under <a href="http://www.opensource.org/licenses/BSD-3-Clause">BSD-3-Clause</a> </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a680ff27c476697f91fcee7a5bddb5243"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_GPS_EPOCH_POSIX&#160;&#160;&#160;315964800UL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The GPS epoch in the POSIX epoch.</p>
<p>The epoch for GPS time is 1980-01-06T00:00:00Z. POSIX measures time in seconds since 1970-01-01T00:00:00Z.</p>
<p>POSIX time expresses time in UTC which is affected by leap seconds. GPS time does not incorporate leap seconds. At the GPS epoch, UTC was 19 seconds ahead of TAI. As of 2012-07-01T00:00:00Z GPS time was 16 seconds ahead of UTC. </p>

</div>
</div>
<a class="anchor" id="ab4dbc266ca6eeac56eee2aa5946411fb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BSP430_GPS_GPS_UTC_OFFSET_S&#160;&#160;&#160;-16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Default offset from GPS to UTC.</p>
<p>This is the number of seconds that must be added to a time in GPS to convert it to be in UTC. The correct value will change over time based on IERS Bulletin C. The application is responsible for managing any updates that might occur during fielded life; see <a class="el" href="gps_8h.html#adafbf0ed765345d6a46e470f0000edbc">vBSP430gpsGPStoUTCOffset_s_ni()</a>. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="aa482fb931136beea5423b9369617da85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(*  iBSP430gpsPPSCallback_ni)(unsigned long pps_tck)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prototype for applications that need 1PPS notifications the infrastructure.</p>
<p>When configured properly a 1PPS signal from a GPS unit is connected to a capture/compare register associated with an MSP430 timer. On receipt of a 1PPS signal, the infrastructure will invoke a function conforming to this prototype that was provided to it by iBSP430gpsInitialize() to tell the application when the pulse was received.</p>
<p>This function is invoked within a hard-interrupt context, so the provided data should be recorded and the function should return as quickly as possible.</p>
<p>The return value is incorporated into the caller's ISR return value, so the application can request a wake-up from LPM if the message requires processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pps_tck</td><td>The captured time at which the rising edge of the 1PPS signal was detected. The resolution is dependent on the underlying timer provided via <a class="el" href="structsBSP430gpsConfiguration.html#ab3f7481db3bd6f1c31cf8625209edb76">sBSP430gpsConfiguration.pps_timer</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ISR return bitmask as described by <a class="el" href="callbacks.html#callback_retval">Interrupt Callback Return Values</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a7482fba2c644ff9d5acd1945f397aefb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(*  iBSP430gpsSerialCallback_ni)(const uint8_t *msg, size_t len, unsigned long rx_utt)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prototype for applications that receive GPS messages from the infrastructure.</p>
<p>The GPS sensor will generally receive messages over a serial connection. When a message is successfully received, it will invoke a function conforming to this prototype that was provided to it by iBSP430gpsInitialize() so that the application can process the message.</p>
<p>This function is invoked within a hard-interrupt context, so the provided data should be recorded and the function should return as quickly as possible. Ownership of the memory associated with the message is transferred to the callee, which must in turn invoke <a class="el" href="gps_8h.html#a2fbd65b94db95384ae39b310173a106a">vBSP430gpsReleaseMessage_ni()</a> to release it when the message is no longer needed. It is permitted to invoke <a class="el" href="gps_8h.html#a2fbd65b94db95384ae39b310173a106a">vBSP430gpsReleaseMessage_ni()</a> within this callback if the application does not need the message.</p>
<p>The <code>msg</code> pointer will be null if the driver started to receive a message but either discovered it to be corrupt or did not have sufficient memory to store it.</p>
<p>There is no notification related to messages that were dropped because they were corrupted.</p>
<p>The return value is incorporated into the caller's ISR return value, so the application can request a wake-up from LPM if the message requires processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>A pointer to the start of the received message (null if the message could not be stored). The message body will be a NUL-terminated NMEA sentence (excluding start-of-sentence and checksum) or a binary packet depending on the underlying sensor's configuration. There is no alignment promise on binary messages.</td></tr>
    <tr><td class="paramname">len</td><td>The number of octets within the message. For NMEA text messages the length includes the terminating NUL added by the driver.</td></tr>
    <tr><td class="paramname">rx_utt</td><td>The <a class="el" href="uptime_8h.html#a7e0b8aeba63d7b2ce965a650125eb8ef">ulBSP430uptime()</a> value when the start-of-sentence character for <code>msg</code> was received.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A ISR return bitmask as described by <a class="el" href="callbacks.html#callback_retval">Interrupt Callback Return Values</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="aae4e88ea10b61ab79a0d718a2db0dd91"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(*  iBSP430gpsTransmitComplete_ni)(const uint8_t *msg, int rc)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Driver notification of transmission completion.</p>
<p>This function is invoked by the driver, possibly from a hard-interrupt context, when transmission of a message submitted by <a class="el" href="gps_8h.html#a58f896ebe61b9270135bd9b92358a483">iBSP430gpsTransmit_ni()</a> has been completed.</p>
<p>This invocation returns ownership of <code>msg</code> to the application.</p>
<p>The return value is incorporated into the caller's ISR return value, so the application can request a wake-up from LPM when the transmission has completed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>the message as originally passed to <a class="el" href="gps_8h.html#a58f896ebe61b9270135bd9b92358a483">iBSP430gpsTransmit_ni()</a></td></tr>
    <tr><td class="paramname">rc</td><td>A non-negative value indicates success and represents the number of octets transmitted (excluding any driver-specific wrapper data such as checksums). A negative value indicates a failure to transmit.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An ISR return bitmask as described by <a class="el" href="callbacks.html#callback_retval">Interrupt Callback Return Values</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a40c1d7be45e0e2200baf289eb8b65bf9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a>  <a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Information required to initialize a GPS driver. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a28de69936bd921716528678a7718f2bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430gpsGPStoUTCOffset_s_ni </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query the GPS to UTC offset.</p>
<p>xBSP430gpsConvertGPStoUTC needs to know how GPS time differs from UTC. This information is present in the GPS signal, but may not be made available by any particular GPS sensor.</p>
<dl class="section warning"><dt>Warning</dt><dd>The correct value for this adjustment will change when a leap second occurs. BSP430 provides no provision to synchronize updates with any use of this call, though the driver for a particular GPS system may do this internally or through some other notification mechanism (e.g. a synthesized NMEA message). </dd></dl>

</div>
</div>
<a class="anchor" id="a34edaac99e0aa4ef7e4ecb906a5a17f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430gpsInitialize_ni </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structsBSP430gpsConfiguration.html">sBSP430gpsConfiguration</a> *&#160;</td>
          <td class="paramname"><em>configp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>devconfigp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize a GPS driver.</p>
<p>On successful completion the NMEA serial and 1PPS capture interfaces are running with interrupt handlers registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configp</td><td>The configuration information required by the driver for NMEA serial and 1PPS interfaces. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The driver does not dereference the configuration pointer after initialization completes.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devconfigp</td><td>optional device-specific information. Pass a null pointer if no device-specific information is required. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The driver may retain the pointer for ongoing use.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the GPS was successfully initialized; -1 to indicate a misconfiguration (e.g. inconsistent information). </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="sensors_2venus6pps_2main_8c-example.html#a35">sensors/venus6pps/main.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="ad964af943254cd00bd92afa9b5cc6421"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430gpsShutdown_ni </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deconfigure a GPS driver.</p>
<p>This shuts down the NMEA serial interface and unhooks the 1PPS capture callbacks.</p>
<dl class="section return"><dt>Returns</dt><dd>0 </dd></dl>

</div>
</div>
<a class="anchor" id="a58f896ebe61b9270135bd9b92358a483"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430gpsTransmit_ni </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="gps_8h.html#aae4e88ea10b61ab79a0d718a2db0dd91">iBSP430gpsTransmitComplete_ni</a>&#160;</td>
          <td class="paramname"><em>complete_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a driver-specific message to the GPS sensor.</p>
<p>This should be implemented by all drivers, but may simply return -1 if the driver does not support commands to the sensor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>pointer to the start of the message. If this call succeeds, the data is owned by the driver and the application must not change its contents until it has been notified through <code>complete_cb</code> that the transmission is complete.</td></tr>
    <tr><td class="paramname">len</td><td>number of octets in the message</td></tr>
    <tr><td class="paramname">complete_cb</td><td>the callback to be invoked when transmission has completed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the driver has accepted ownership of <code>msg</code> and will transmit it; a negative error code if transmission could not be accepted. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="sensors_2venus6pps_2main_8c-example.html#a43">sensors/venus6pps/main.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="adafbf0ed765345d6a46e470f0000edbc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vBSP430gpsGPStoUTCOffset_s_ni </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gps_to_utc_offset_s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the GPS to UTC offset.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gps_to_utc_offset_s</td><td>The number of seconds that need to be added to a GPS time to produce a UTC time. Unless the rotation of the earth speeds up unexpectedly, this should be a negative value such as -16.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="gps_8h.html#a28de69936bd921716528678a7718f2bc">iBSP430gpsGPStoUTCOffset_s_ni()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a2fbd65b94db95384ae39b310173a106a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vBSP430gpsReleaseMessage_ni </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function called by application to release a message received through <a class="el" href="gps_8h.html#a7482fba2c644ff9d5acd1945f397aefb">iBSP430gpsSerialCallback_ni()</a></p>
<p>This invocation returns ownership of <code>msg</code> to the GPS driver. It must be invoked lest the GPS driver run out of memory in which to store received messages. It is safe to invoke this from within the callback itself, or for the application to do so when it has completed processing the message.</p>
<p>Messages need not be released in the order in which the driver provided them; e.g. an ACK/NACK could be processed within the callback before the application completes processing a message received earlier.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>the message pointer as passed to <a class="el" href="gps_8h.html#a7482fba2c644ff9d5acd1945f397aefb">iBSP430gpsSerialCallback_ni()</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="sensors_2venus6pps_2main_8c-example.html#a13">sensors/venus6pps/main.c</a>.</dd>
</dl>
</div>
</div>
<a class="anchor" id="a3c372f07bd98a2de291929c21a749caa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t xBSP430gpsConvertGPStoUTC_ni </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>weekno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>sow</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert a GPS time into UTC.</p>
<p>This function converts a GPS time expressed as a week number and second within the week to a UTC time expressed as seconds since the POSIX epoch. This references <a class="el" href="gps_8h.html#a28de69936bd921716528678a7718f2bc">iBSP430gpsGPStoUTCOffset_s_ni()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">weekno</td><td>GPS week number. The value passed should have been adjusted for any week number rollovers due to the specification requiring it to be taken modulo 1024; i.e. it should be the total number of weeks since the GPS epoch.</td></tr>
    <tr><td class="paramname">sow</td><td>Number of seconds within the GPS week.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A POSIX time in UTC. </dd></dl>
<dl><dt><b>Examples: </b></dt><dd><a class="el" href="sensors_2venus6pps_2main_8c-example.html#a60">sensors/venus6pps/main.c</a>.</dd>
</dl>
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Apr 27 2013 18:46:22 for BSP430 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.2
</small></address>
</body>
</html>
